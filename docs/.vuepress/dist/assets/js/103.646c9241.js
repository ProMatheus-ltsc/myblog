(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{1188:function(s,a,t){s.exports=t.p+"assets/img/image-20220411173130250.e5c2e700.png"},1189:function(s,a,t){s.exports=t.p+"assets/img/image-20220413154817590.9773bb2e.png"},1728:function(s,a,t){"use strict";t.r(a);var e=t(65),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"微服务部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#微服务部署"}},[s._v("#")]),s._v(" 微服务部署")]),s._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#开发环境"}},[s._v("开发环境")])]),e("li",[e("a",{attrs:{href:"#spring-cloud-netflix"}},[s._v("Spring cloud Netflix")])]),e("li",[e("a",{attrs:{href:"#eureka"}},[s._v("eureka")])]),e("li",[e("a",{attrs:{href:"#高可用"}},[s._v("高可用")])]),e("li",[e("a",{attrs:{href:"#feign-远程调用、ribbin-负载均衡和重试"}},[s._v("Feign 远程调用、Ribbin 负载均衡和重试")])]),e("li",[e("a",{attrs:{href:"#zuul-api-网关"}},[s._v("Zuul API 网关")])]),e("li",[e("a",{attrs:{href:"#hystrix-容错和限流"}},[s._v("Hystrix 容错和限流")])]),e("li",[e("a",{attrs:{href:"#turbine"}},[s._v("Turbine")])]),e("li",[e("a",{attrs:{href:"#spring-cloud-config-配置中心"}},[s._v("Spring cloud config 配置中心")])]),e("li",[e("a",{attrs:{href:"#vmware"}},[s._v("VMware")])]),e("li",[e("a",{attrs:{href:"#rabbitmq"}},[s._v("Rabbitmq")])]),e("li",[e("a",{attrs:{href:"#消息服务使用案例"}},[s._v("消息服务使用案例")])]),e("li",[e("a",{attrs:{href:"#spring-cloud-config-bus-配置刷新"}},[s._v("Spring cloud config + BUS 配置刷新")])]),e("li",[e("a",{attrs:{href:"#sleuth-zipkin-链路跟踪"}},[s._v("Sleuth + Zipkin 链路跟踪")])]),e("li",[e("a",{attrs:{href:"#eureka注册-选择正确网卡、注册ip而不是主机名"}},[s._v("eureka注册，选择正确网卡、注册ip而不是主机名")])]),e("li",[e("a",{attrs:{href:"#订单流量削峰"}},[s._v("订单流量削峰")])]),e("li",[e("a",{attrs:{href:"#分布式事务"}},[s._v("分布式事务")]),e("ul",[e("li",[e("a",{attrs:{href:"#业务案例"}},[s._v("业务案例")])]),e("li",[e("a",{attrs:{href:"#全局唯一id发号器"}},[s._v("全局唯一id发号器")])]),e("li",[e("a",{attrs:{href:"#订单调用发号器、库存、账户"}},[s._v("订单调用发号器、库存、账户")])])])]),e("li",[e("a",{attrs:{href:"#分布式事务"}},[s._v("分布式事务")]),e("ul",[e("li",[e("a",{attrs:{href:"#seata"}},[s._v("seata")])]),e("li",[e("a",{attrs:{href:"#seata-at-事务"}},[s._v("seata at 事务")])]),e("li",[e("a",{attrs:{href:"#tcc-事务方案"}},[s._v("TCC 事务方案")])])])]),e("li",[e("a",{attrs:{href:"#rocketmq"}},[s._v("Rocketmq")]),e("ul",[e("li",[e("a",{attrs:{href:"#搭建服务器"}},[s._v("搭建服务器")])]),e("li",[e("a",{attrs:{href:"#rocketmq启动命令"}},[s._v("Rocketmq启动命令")])]),e("li",[e("a",{attrs:{href:"#rocketmq-收发消息api"}},[s._v("Rocketmq  收发消息api")])]),e("li",[e("a",{attrs:{href:"#可靠消息最终一致性事务"}},[s._v("可靠消息最终一致性事务")])])])]),e("li",[e("a",{attrs:{href:"#devops-开发运维一体化"}},[s._v("DevOps 开发运维一体化")]),e("ul",[e("li",[e("a",{attrs:{href:"#docker"}},[s._v("Docker")])])])]),e("li",[e("a",{attrs:{href:"#elasticsearch"}},[s._v("Elasticsearch")]),e("ul",[e("li",[e("a",{attrs:{href:"#搭建-es-服务器"}},[s._v("搭建 ES 服务器")])]),e("li",[e("a",{attrs:{href:"#拼多商城搜索条"}},[s._v("拼多商城搜索条")])]),e("li",[e("a",{attrs:{href:"#kubernetes"}},[s._v("Kubernetes")])]),e("li",[e("a",{attrs:{href:"#安装搭建-k8s-集群"}},[s._v("安装搭建 K8s 集群")])]),e("li",[e("a",{attrs:{href:"#k8s三个核心概念"}},[s._v("K8s三个核心概念")])])])]),e("li",[e("a",{attrs:{href:"#小结"}},[s._v("小结")]),e("ul",[e("li",[e("a",{attrs:{href:"#spring-cloud-netflix"}},[s._v("Spring cloud Netflix")])]),e("li",[e("a",{attrs:{href:"#消息服务"}},[s._v("消息服务")])]),e("li",[e("a",{attrs:{href:"#分布式事务"}},[s._v("分布式事务")])]),e("li",[e("a",{attrs:{href:"#devops"}},[s._v("DevOps")])]),e("li",[e("a",{attrs:{href:"#elasticsearch"}},[s._v("Elasticsearch")])])])])])]),e("p"),s._v(" "),e("h2",{attrs:{id:"开发环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开发环境"}},[s._v("#")]),s._v(" 开发环境")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("IDEA")])]),s._v(" "),e("li",[e("p",[s._v("Lombok")])]),s._v(" "),e("li",[e("p",[s._v("EditStarters")])]),s._v(" "),e("li",[e("p",[s._v("Free MyBatis Plugin / MybatisX")])]),s._v(" "),e("li",[e("p",[s._v("Maven Helper")])]),s._v(" "),e("li",[e("p",[s._v("Maven")]),s._v(" "),e("ul",[e("li",[s._v("使用阿里仓库和中央仓库，来回切换更新\n"),e("ul",[e("li",[s._v("settings.xml 不配置任何镜像仓库，默认使用中央仓库")])])])]),s._v(" "),e("div",{staticClass:"language-xml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("settings")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("xmlns")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("http://maven.apache.org/SETTINGS/1.0.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("xmlns:")]),s._v("xsi")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("http://www.w3.org/2001/XMLSchema-instance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("xsi:")]),s._v("schemaLocation")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("http://maven.apache.org/SETTINGS/1.0.0\n                          https://maven.apache.org/xsd/settings-1.0.0.xsd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("localRepository")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("D:\\home\\java\\maven_repository"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("localRepository")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n\t"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("mirrors")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--<mirror>--\x3e")]),s._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--\t<id>alimaven</id>--\x3e")]),s._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--\t<name>aliyun maven</name>--\x3e")]),s._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--\t<url>http://maven.aliyun.com/nexus/content/groups/public/</url>--\x3e")]),s._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--\t<mirrorOf>central</mirrorOf>--\x3e")]),s._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--</mirror>--\x3e")]),s._v("\n\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--<mirror>--\x3e")]),s._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--\t<id>huaweicloud</id>--\x3e")]),s._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--\t<mirrorOf>*</mirrorOf>--\x3e")]),s._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--\t<url>https://mirrors.huaweicloud.com/repository/maven/</url>--\x3e")]),s._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--</mirror>--\x3e")]),s._v("\n\n\t"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("mirrors")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("settings")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("在本地仓库目录中搜索“lastupdate”，删除所有lastupdate文件后再重新更新")])]),s._v(" "),e("li",[e("p",[s._v("找到本地仓库的依赖包，删除后重新更新")])]),s._v(" "),e("li",[e("p",[s._v("复制同学的本地仓库中的依赖包")])])])]),s._v(" "),e("li",[e("p",[s._v("新工程的  Maven 默认配置：")]),s._v(" "),e("ul",[e("li",[s._v("File - New Projects Settings - Settings for new projects")])])]),s._v(" "),e("li",[e("p",[s._v("springboot版本：  2.3.2.RELEASE")])]),s._v(" "),e("li",[e("p",[s._v("springcloud版本： Hoxton.SR12")])])]),s._v(" "),e("h2",{attrs:{id:"spring-cloud-netflix"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spring-cloud-netflix"}},[s._v("#")]),s._v(" Spring cloud Netflix")]),s._v(" "),e("ul",[e("li",[s._v("注册中心\n"),e("ul",[e("li",[s._v("Eureka")])])]),s._v(" "),e("li",[s._v("配置中心\n"),e("ul",[e("li",[s._v("Spring cloud config")])])]),s._v(" "),e("li",[s._v("远程调用/负载均衡\n"),e("ul",[e("li",[s._v("Feign")]),s._v(" "),e("li",[s._v("Ribbon")])])]),s._v(" "),e("li",[s._v("系统容错、限流\n"),e("ul",[e("li",[s._v("Hystrix")]),s._v(" "),e("li",[s._v("容错：\n"),e("ul",[e("li",[s._v("容错的手段：降级")])])]),s._v(" "),e("li",[s._v("限流：\n"),e("ul",[e("li",[s._v("限流的手段：熔断")])])])])]),s._v(" "),e("li",[s._v("数据监控\n"),e("ul",[e("li",[s._v("Hystrix dashboard / Turbine")]),s._v(" "),e("li",[s._v("链路跟踪 Sleuth / Zipkin")])])])]),s._v(" "),e("h2",{attrs:{id:"eureka"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eureka"}},[s._v("#")]),s._v(" eureka")]),s._v(" "),e("p",[e("strong",[s._v("搭建eureka服务器：")])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("新建 spring 模块：sp05-eureka")])]),s._v(" "),e("li",[e("p",[s._v("添加依赖： eureka server")])]),s._v(" "),e("li",[e("p",[s._v("yml")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[s._v("关闭自我保护模式\n主机名：eureka1\n针对单台服务器：\n\t不向自己注册\n\t不从自己拉取\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动类添加注解："),e("code",[s._v("@EnableEurekaServer")]),s._v("\n用来触发 eureka server 的自动配置")])])]),s._v(" "),e("p",[e("strong",[s._v("eureka运行机制：")])]),s._v(" "),e("ol",[e("li",[e("strong",[s._v("注册")]),s._v("\n客户端应用会一次一次地反复注册，直到注册成功为止")]),s._v(" "),e("li",[e("strong",[s._v("拉取")]),s._v("\n客户端应用每隔30秒，拉取一次注册表，来刷新本地缓存的注册表")]),s._v(" "),e("li",[e("strong",[s._v("心跳")]),s._v("\n客户端应用每隔30秒发送一次心跳\n服务器连续3次收不到一个模块的心跳，会删除它的注册信息")]),s._v(" "),e("li",[e("strong",[s._v("自我保护模式")]),s._v("\n由于网络故障，15分钟内，85%服务器出现心跳异常，会自动进入保护模式。\n所有注册信息都不删除\n等待网络恢复后，会自动退出保护模式，恢复到正常模式\n开发调试期间，应该禁用保护模式，避免影响测试")])]),s._v(" "),e("p",[e("strong",[s._v("eureka客户端：")])]),s._v(" "),e("p",[s._v("修改 2,3,4 模块")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("依赖： eureka client")])]),s._v(" "),e("li",[e("p",[s._v("yml")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[s._v("服务器注册地址： http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//eureka1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("2001/eureka\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("p",[s._v("http://eureka1:2001/eureka eureka子路径，是客户端调用的 api 路径")]),s._v(" "),e("h2",{attrs:{id:"高可用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#高可用"}},[s._v("#")]),s._v(" 高可用")]),s._v(" "),e("p",[e("strong",[s._v("商品高可用：")])]),s._v(" "),e("p",[s._v("在 8001 和 8002 端口，重复启动两个商品服务")]),s._v(" "),e("p",[s._v("命令行参数来设置端口：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令行参数，可以覆盖 yml 配置的端口")]),s._v("\njava -jar item.jar --server.port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v("\n\njava -jar item.jar --server.port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8002")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("idea启动配置中，配置命令参数：")]),s._v(" "),e("ul",[e("li",[s._v("运行配置的下拉菜单 -- Edit Configuration")]),s._v(" "),e("li",[s._v("修改 program arguments，添加参数： "),e("code",[s._v("--server.port=8001")])]),s._v(" "),e("li",[s._v("左边的商品启动配置，复制一份，改成 "),e("code",[s._v("--server.port=8002")])])]),s._v(" "),e("p",[e("strong",[s._v("eureka高可用：")])]),s._v(" "),e("ol",[e("li",[s._v("新建两个profile配置文件：")])]),s._v(" "),e("ul",[e("li",[s._v("application-eureka1.yml")]),s._v(" "),e("li",[s._v("application-eureka2.yml")])]),s._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[s._v("设置两个 eureka 的启动配置参数：\n"),e("ul",[e("li",[s._v("--spring.progiles.active=eureka1")]),s._v(" "),e("li",[s._v("--spring.progiles.active=eureka2")])])]),s._v(" "),e("li",[s._v("客户端应用连接两个eureka服务：\n"),e("ul",[e("li",[s._v("defaultZone: http://eureka1:2001/eureka,http://eureka2:2002/eureka")])])])]),s._v(" "),e("h2",{attrs:{id:"feign-远程调用、ribbin-负载均衡和重试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#feign-远程调用、ribbin-负载均衡和重试"}},[s._v("#")]),s._v(" Feign 远程调用、Ribbin 负载均衡和重试")]),s._v(" "),e("p",[s._v("修改 04 项目，完成远程调用")]),s._v(" "),e("ol",[e("li",[s._v("添加 feign 依赖")]),s._v(" "),e("li",[s._v("启动类注解： "),e("code",[s._v("@EnableFeignClients")]),s._v("\n触发 Feign 自动配置，扫描远程调用接口，创建动态代理对象")]),s._v(" "),e("li",[s._v("定义远程调用接口\n"),e("ul",[e("li",[s._v("ItemClient")]),s._v(" "),e("li",[s._v("UserClient")])])]),s._v(" "),e("li",[s._v("OrderServiceImpl ，完成远程调用")])]),s._v(" "),e("p",[e("strong",[s._v("Feign 集成 Ribbon")]),s._v("：")]),s._v(" "),e("ul",[e("li",[s._v("默认启用了负载均衡和重试")])]),s._v(" "),e("p",[e("strong",[s._v("Ribbon重试：")])]),s._v(" "),e("p",[s._v("调用后台服务失败，可以自动进行重试调用")]),s._v(" "),e("p",[s._v("重试参数：")]),s._v(" "),e("ul",[e("li",[s._v("MaxAutoRetries - 单台服务器的重试次数，默认 0")]),s._v(" "),e("li",[s._v("MaxAutoRetriesNextServer - 更换服务器的次数，默认 1")]),s._v(" "),e("li",[s._v("ReadTimeout - 等待响应的超时时间，默认 1000")])]),s._v(" "),e("p",[e("strong",[s._v("测试Ribbon重试:")])]),s._v(" "),e("ul",[e("li",[s._v("02商品，添加随机延迟代码")]),s._v(" "),e("li",[s._v("04调用02，超时失败，会进行重试")])]),s._v(" "),e("h2",{attrs:{id:"zuul-api-网关"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#zuul-api-网关"}},[s._v("#")]),s._v(" Zuul API 网关")]),s._v(" "),e("p",[s._v("系统的调用入口")]),s._v(" "),e("ul",[e("li",[s._v("统一的调用入口")]),s._v(" "),e("li",[s._v("统一的权限校验")]),s._v(" "),e("li",[s._v("集成 Ribbon")]),s._v(" "),e("li",[s._v("集成 Hystrix")])]),s._v(" "),e("p",[e("strong",[s._v("统一的调用入口：")])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("新建 spring 模块： sp06-zuul")])]),s._v(" "),e("li",[e("p",[s._v("添加依赖：")]),s._v(" "),e("ul",[e("li",[s._v("zuul")]),s._v(" "),e("li",[s._v("eureka client")]),s._v(" "),e("li",[s._v("sp01")])])]),s._v(" "),e("li",[e("p",[s._v("yml")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ** 包含深层子路径")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# *  只包含一层路径")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("zuul")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("routes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("item-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /item"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service/"),e("span",{pre:!0,attrs:{class:"token important"}},[s._v("**")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("user-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /user"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service/"),e("span",{pre:!0,attrs:{class:"token important"}},[s._v("**")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("order-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /order"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service/"),e("span",{pre:!0,attrs:{class:"token important"}},[s._v("**")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动类注解： "),e("code",[s._v("@EnableZuulProxy")])])])]),s._v(" "),e("p",[e("strong",[s._v("统一权限校验：")])]),s._v(" "),e("p",[s._v("模拟登陆：")]),s._v(" "),e("p",[s._v("http://localhost:3001/item-service/i6juh65g4f3  没有登录，阻止访问")]),s._v(" "),e("p",[s._v("http://localhost:3001/item-service/i6juh65g4f3?jwt=iu5hyg45f34t43y  已经登录，可以访问")]),s._v(" "),e("ol",[e("li",[s._v("新建过滤器类 AccessFilter，继承 ZuulFilter")]),s._v(" "),e("li",[s._v("按规则实现抽象方法")]),s._v(" "),e("li",[s._v("添加 "),e("code",[s._v("@Component")]),s._v(" 注解")])]),s._v(" "),e("ul",[e("li",[s._v("Zuul 自动配置，会在spring容器中发现过滤器实例，完成自动配置")])]),s._v(" "),e("p",[e("strong",[s._v("Zuul集成Ribbon：")])]),s._v(" "),e("ul",[e("li",[s._v("默认启动 ribbon 的负载均衡")]),s._v(" "),e("li",[s._v("默认不启动用重试\n"),e("ul",[e("li",[s._v("在最前面网关位置重试，会造成大量服务器压力翻倍")])])])]),s._v(" "),e("p",[e("strong",[s._v("Zuul启用重试：")])]),s._v(" "),e("ul",[e("li",[s._v("添加 spring-retry 依赖")]),s._v(" "),e("li",[s._v("yml配置： zuul.retryable=true")])]),s._v(" "),e("p",[e("strong",[s._v("Zuul 集成 Hysrix：")])]),s._v(" "),e("p",[s._v("默认已经启用了 Hystrix")]),s._v(" "),e("h2",{attrs:{id:"hystrix-容错和限流"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hystrix-容错和限流"}},[s._v("#")]),s._v(" Hystrix 容错和限流")]),s._v(" "),e("ul",[e("li",[s._v("容错 - 处理远程调用的错误\n"),e("ul",[e("li",[s._v("容错的手段： 降级")])])]),s._v(" "),e("li",[s._v("限流 - 由于流量过大造成故障，要限制后台模块的访问流量，减轻压力\n"),e("ul",[e("li",[s._v("限流的手段： 熔断")])])])]),s._v(" "),e("p",[e("strong",[s._v("容错、降级：")])]),s._v(" "),e("ul",[e("li",[s._v("实现 zuul 的接口： FallbackProvider")]),s._v(" "),e("li",[s._v("按规则实现抽象方法")]),s._v(" "),e("li",[s._v("添加 "),e("code",[s._v("@component")]),s._v(" 注解")]),s._v(" "),e("li",[s._v("zuul 会自动配置降级类")])]),s._v(" "),e("p",[e("strong",[s._v("限流、熔断：")])]),s._v(" "),e("p",[s._v("Hystrix熔断条件，断路器打开条件：")]),s._v(" "),e("ul",[e("li",[s._v("10秒20次请求（必须首先满足）")]),s._v(" "),e("li",[s._v("50%请求出错，执行了降级")])]),s._v(" "),e("p",[e("strong",[s._v("断路器打开后，会进入“半开状态”：")])]),s._v(" "),e("ul",[e("li",[s._v("尝试向后台模块发送一次客户端调用")]),s._v(" "),e("li",[s._v("如果调用成功，会关闭断路器，恢复正常")]),s._v(" "),e("li",[s._v("如果调用失败，继续保持打开状态")])]),s._v(" "),e("p",[e("strong",[s._v("Hystrix dashboard 仪表盘数据监控：")])]),s._v(" "),e("p",[s._v("利用 Actuator 来暴露 Hystrix 的监控日志，Hystrix dashboard会抓取日志，对日志进行分析处理")]),s._v(" "),e("p",[e("strong",[s._v("Actuator")])]),s._v(" "),e("p",[s._v("spring提供的一个项目指标工具")]),s._v(" "),e("ul",[e("li",[s._v("健康状态")]),s._v(" "),e("li",[s._v("spring容器中所有的对象")]),s._v(" "),e("li",[s._v("springmvc 所有的访问路径")]),s._v(" "),e("li",[s._v("jvm堆内存镜像文件")]),s._v(" "),e("li",[s._v("hystrix 监控日志")])]),s._v(" "),e("p",[s._v("添加 actuator：")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("添加 actuator 依赖")])]),s._v(" "),e("li",[e("p",[s._v("yml配置")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("m.e.w.e.i")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v("      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露所有的监控指标")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("m.e.w.e.i")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" health"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("beans"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("mappings      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露感兴趣的指标")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("m.e.w.e.i")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" hystrix.stream\t\t\t  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露hystrix监控日志")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("访问查看所有监控指标的地址：\n"),e("code",[s._v("http://localhost:3001/actuator")])])])]),s._v(" "),e("p",[e("strong",[s._v("搭建 Hyastrix dashboard：")])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("新建 spring 模块：sp07-hystrix-dashboard")])]),s._v(" "),e("li",[e("p",[s._v("添加依赖： hystrix dashboard")])]),s._v(" "),e("li",[e("p",[s._v("yml")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("允许抓取的服务器列表")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动类注解： "),e("code",[s._v("@EnableHystrixDashboard")])])])]),s._v(" "),e("ul",[e("li",[s._v("浏览器访问： "),e("code",[s._v("http://localhost:4001/hystrix")]),s._v("\n从 "),e("code",[s._v("http://localhost:3001/actuator/hystrix.stream")]),s._v(" 抓取日志")])]),s._v(" "),e("h2",{attrs:{id:"turbine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#turbine"}},[s._v("#")]),s._v(" Turbine")]),s._v(" "),e("p",[s._v("从多台服务器聚合监控数据，将聚合后的数据交给仪表盘进行处理")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("新建  spring 模块： sp08-turbine")])]),s._v(" "),e("li",[e("p",[s._v("添加依赖")]),s._v(" "),e("ul",[e("li",[s._v("turbine")]),s._v(" "),e("li",[s._v("eureka client")])])]),s._v(" "),e("li",[e("p",[s._v("yml")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[s._v('抓取的模块：zuul\n为聚合后的数据命名：new String("default")\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动类注解： "),e("code",[s._v("@EnableTurbine")])])])]),s._v(" "),e("ul",[e("li",[s._v("聚合后的日志数据访问路径：\nhttp://localhost:5001/turbine.stream")])]),s._v(" "),e("h2",{attrs:{id:"spring-cloud-config-配置中心"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spring-cloud-config-配置中心"}},[s._v("#")]),s._v(" Spring cloud config 配置中心")]),s._v(" "),e("p",[s._v("集中地管理和维护配置文件")]),s._v(" "),e("p",[e("strong",[s._v("检查Git环境：")])]),s._v(" "),e("ol",[e("li",[s._v("访问 git 官网下载 git")]),s._v(" "),e("li",[s._v("安装 git")]),s._v(" "),e("li",[s._v("settings -- git -- 配置 git.exe 的路径")])]),s._v(" "),e("p",[e("strong",[s._v("准备本地Git仓库：")])]),s._v(" "),e("ol",[e("li",[s._v("在 springcloud1 工程目录下，新建 config 文件夹")]),s._v(" "),e("li",[s._v("复制 2,3,4 的 application.yml 到 config 文件夹\n"),e("ul",[e("li",[s._v("item-service-dev.yml")]),s._v(" "),e("li",[s._v("user-service-dev.yml")]),s._v(" "),e("li",[s._v("order-service-dev.yml")])])]),s._v(" "),e("li",[s._v("double shift  --  action -- 搜索 create git repository")]),s._v(" "),e("li",[s._v("选择 springcloud1 工程目录作为本地的仓库目录\n"),e("ul",[e("li",[e("strong",[s._v("如果已经有仓库，不要重复创建，也不不要嵌套创建仓库")])])])]),s._v(" "),e("li",[s._v("double shift  --  action -- 搜索 commit")]),s._v(" "),e("li",[s._v("全选文件，填写提交信息，完成提交")])]),s._v(" "),e("p",[e("strong",[s._v("本地仓库推送到远程仓库：")])]),s._v(" "),e("ol",[e("li",[s._v("double shift -- action -- 搜索 push")]),s._v(" "),e("li",[s._v("点 define remote，粘贴远程仓库地址")])]),s._v(" "),e("p",[e("strong",[s._v("防止配置中心的的配置，覆盖本地配置和命令参数：")])]),s._v(" "),e("ul",[e("li",[s._v("override-none = true")])]),s._v(" "),e("p",[e("strong",[s._v("搭建配置中心：")])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("新建 spring 模块： sp09-config")])]),s._v(" "),e("li",[e("p",[s._v("添加依赖：")]),s._v(" "),e("ul",[e("li",[s._v("config server")]),s._v(" "),e("li",[s._v("eureka client")])])]),s._v(" "),e("li",[e("p",[s._v("yml")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[s._v("git仓库的地址： https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//gitee.com/账户/仓库\n存放配置文件的文件夹： config\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动类注解： "),e("code",[s._v("@EnableConfigServer")])])])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("api.http 调用测试")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###")]),s._v("\nGET http://locahost:6001/item-service/dev\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###")]),s._v("\nGET http://locahost:6001/user-service/dev\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###")]),s._v("\nGET http://locahost:6001/order-service/dev\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("检查注册表中的注册信息： "),e("code",[s._v("config-server")])])])]),s._v(" "),e("p",[e("strong",[s._v("配置中心的客户端应用：")])]),s._v(" "),e("ol",[e("li",[s._v("添加依赖： config client")]),s._v(" "),e("li",[s._v("新建配置文件： "),e("code",[s._v("bootstrap.yml")]),s._v(" "),e("ul",[e("li",[s._v("引导配置，\n"),e("ul",[e("li",[s._v("项目启动时，先执行引导配置")]),s._v(" "),e("li",[s._v("之后才执行 application.yml  的应用配置")])])])])]),s._v(" "),e("li",[s._v("添加三条配置：\n"),e("ol",[e("li",[s._v("连接 eureka")]),s._v(" "),e("li",[s._v("设置配置陪着中心的 service id")]),s._v(" "),e("li",[s._v("下载配置文件")])])])]),s._v(" "),e("ul",[e("li",[s._v("控制台前两行的日志：\n"),e("ul",[e("li",[s._v("连接 6001")]),s._v(" "),e("li",[s._v("下载指定的配置文件")])])])]),s._v(" "),e("p",[e("strong",[s._v("启动顺序：")])]),s._v(" "),e("ol",[e("li",[s._v("启动 05\n等待05完全启动完成")]),s._v(" "),e("li",[s._v("启动 09\n等待09完全启动完成")]),s._v(" "),e("li",[s._v("检查注册表，有没有 config-server")]),s._v(" "),e("li",[s._v("启动 2,3")]),s._v(" "),e("li",[s._v("启动 4")]),s._v(" "),e("li",[s._v("查看 2,3,4 的控制台，连接6001的日志")]),s._v(" "),e("li",[s._v("启动 6")])]),s._v(" "),e("h2",{attrs:{id:"vmware"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vmware"}},[s._v("#")]),s._v(" VMware")]),s._v(" "),e("p",[s._v("16+")]),s._v(" "),e("p",[e("strong",[s._v("Nat网络网段设置成 "),e("code",[s._v("192.168.64.0")]),s._v("：")])]),s._v(" "),e("ul",[e("li",[s._v("编辑 -- 虚拟网络编辑器 -- 上面选择 VMnet8 -- 左下角修改网段\n"),e("ul",[e("li",[s._v("注意： "),e("strong",[s._v("第四个值是0")])])])])]),s._v(" "),e("p",[e("strong",[s._v("虚拟机：")])]),s._v(" "),e("ul",[e("li",[s._v("课前资料/虚拟机/centos-8-2105.zip\n解压缩")]),s._v(" "),e("li",[s._v("双击 "),e("code",[s._v("centos-8-2105.vmx")]),s._v("  加载虚拟机镜像")]),s._v(" "),e("li",[s._v("启动虚拟机\n"),e("ul",[e("li",[s._v("按提示选择 “已复制虚拟机”")]),s._v(" "),e("li",[s._v("如果看到“硬件不兼容”\n"),e("ul",[e("li",[s._v("右键点虚拟机 -- 管理 -- 更改硬件兼容性 -- 选择自己的 vmware 版本")])])])])]),s._v(" "),e("li",[s._v("登录的用户名和密码都是 "),e("code",[s._v("root")])])]),s._v(" "),e("p",[e("strong",[s._v("虚拟机中的基础设置：")])]),s._v(" "),e("ul",[e("li",[s._v("设置了阿里的 yum 安装源\n"),e("ul",[e("li",[s._v("阿里yum安装源最近做了调整，需要重新设置 yum 安装源")])])]),s._v(" "),e("li",[s._v("安装了三个工具： python、pip、ansible")]),s._v(" "),e("li",[s._v("两个脚本文件，用来设置 ip 地址\n"),e("ul",[e("li",[s._v("ip-dhcp： 自动获取ip")]),s._v(" "),e("li",[s._v("ip-static： 设置固定ip")])])])]),s._v(" "),e("p",[e("strong",[s._v("设置 ip 地址：")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./ip-dhcp\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果设置ip失败，可以尝试执行下面两条命令，再重新设置ip：")]),s._v("\nnmcli n on\n\nsystemctl restart NetworkManager\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看ens33网卡的ip")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v(" ens33\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("p",[e("strong",[s._v("重新设置阿里 yum 安装源：")])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("moboxterm  连接服务器")])]),s._v(" "),e("li",[e("p",[s._v("执行下面操作：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份yum源配置")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/yum.repos.d/CentOS-Linux-BaseOS.repo /etc/yum.repos.d/CentOS-Linux-BaseOS.repo.backup\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载阿里 yum 源配置文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -o /etc/yum.repos.d/CentOS-Linux-BaseOS.repo https://mirrors.aliyun.com/repo/Centos-vault-8.5.2111.repo\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mirrors.cloud.aliyuncs.com 服务器地址改成 mirrors.aliyuncs.com")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i -e "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/mirrors.cloud.aliyuncs.com/d'")]),s._v(" -e "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/mirrors.aliyuncs.com/d'")]),s._v(" /etc/yum.repos.d/CentOS-Linux-BaseOS.repo\n\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/yum.repos.d/CentOS-Linux-AppStream.repo\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注释掉 mirrorlist，")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加下面一行")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://mirrors.aliyun.com/centos-vault/8.5.2111/AppStream/"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$basearch")]),s._v("/os/\n\nyum makecache\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])])])]),s._v(" "),e("p",[e("strong",[s._v("准备 Docker 服务器：")])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("centos-8-2105 关机： "),e("code",[s._v("shutdown -h now")])])]),s._v(" "),e("li",[e("p",[s._v("克隆 centos-8-2105： docker-base")])]),s._v(" "),e("li",[e("p",[s._v("查看ip")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("用 moboxterm 连接服务器，上传离线安装文件")]),s._v(" "),e("ul",[e("li",[s._v("DevOps课前资料\\docker\\docker-install 文件夹\n上传到  /root/ 目录")])])]),s._v(" "),e("li",[e("p",[s._v("按照 csdn 笔记安装 docker："),e("a",{attrs:{href:"https://wanght.blog.csdn.net/article/details/117327543",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker（一） - 离线安装"),e("OutboundLink")],1),s._v("\n从"),e("strong",[s._v("第三步")]),s._v("开始安装")])]),s._v(" "),e("li",[e("p",[s._v("关闭防火墙")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("systemctl stop firewalld\n\nsystemctl disable firewalld\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("关机： "),e("code",[s._v("shutdown -h now")])])])]),s._v(" "),e("h2",{attrs:{id:"rabbitmq"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq"}},[s._v("#")]),s._v(" Rabbitmq")]),s._v(" "),e("p",[e("strong",[s._v("Docker运行Rabbitmq服务：")])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("克隆 docker base： rabbitmq")])]),s._v(" "),e("li",[e("p",[s._v("设置固定ip：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./ip-static\nip: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".64.140\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果设置ip出错，参考上面 ip 设置，执行两条命令")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("上传文件到 /root/")]),s._v(" "),e("ul",[e("li",[s._v("DevOps课前资料\\docker\\rabbit-image.gz")])])]),s._v(" "),e("li",[e("p",[s._v("导入镜像：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" load -i rabbit-image.gz\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("参考 csdn 笔记启动 rabbitmq")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://wanght.blog.csdn.net/article/details/102810522",target:"_blank",rel:"noopener noreferrer"}},[s._v("RabbitMQ"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("Docker运行rabbitmq")])])])]),s._v(" "),e("p",[e("strong",[s._v("工作模式合理分发消息：")])]),s._v(" "),e("ol",[e("li",[s._v("使用手动确认模式\n消息分发不合理的原因，是服务器不知道消费者有没有处理完消息。\n使用手动确认模式，不仅是保证消息被正确处理，也可以让服务器知道消费者有没有处理完消息。")]),s._v(" "),e("li",[s._v("qos=1\n每次只接收1条消息，处理完成之前不接收下一条。\n只在手动确认模式才有效。")])]),s._v(" "),e("p",[e("strong",[s._v("防止服务器崩溃，消息丢失：")])]),s._v(" "),e("p",[s._v("消息的持久化：")]),s._v(" "),e("ol",[e("li",[s._v("队列设置成持久队列")]),s._v(" "),e("li",[s._v("发送的消息设置成持久消息")])]),s._v(" "),e("p",[e("strong",[s._v("常见的面试题：rabbitmq防止消息丢失：")])]),s._v(" "),e("ol",[e("li",[s._v("手动确认模式\n保证消息被正确处理，不丢失消息")]),s._v(" "),e("li",[s._v("消息的持久化\n防止服务器崩溃丢失消息")])]),s._v(" "),e("h2",{attrs:{id:"消息服务使用案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#消息服务使用案例"}},[s._v("#")]),s._v(" 消息服务使用案例")]),s._v(" "),e("ol",[e("li",[s._v("BUS 配置刷新\n通过Rabbitmq发送刷新指令到各个模块，各个模块接收到指令后执行刷新操作\n使用Rabbitmq的主题模式")]),s._v(" "),e("li",[s._v("Sleuth+Zipkin链路跟踪\nSleuth产生的链路跟踪日志，发送到Rabbitmq，\nZipkin从Rabbitmq接收日志\n简单模式")]),s._v(" "),e("li",[s._v("商城系统，订单流量削峰\n商城系统中产生的订单，发送到消息队列，\n后台的消费者模块接收并存储订单\n简单模式、工作模式")]),s._v(" "),e("li")]),s._v(" "),e("h2",{attrs:{id:"spring-cloud-config-bus-配置刷新"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spring-cloud-config-bus-配置刷新"}},[s._v("#")]),s._v(" Spring cloud config + BUS 配置刷新")]),s._v(" "),e("p",[s._v("修改 2,3,4,9")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("添加依赖：")]),s._v(" "),e("ul",[e("li",[s._v("bus")]),s._v(" "),e("li",[s._v("rabbitmq")]),s._v(" "),e("li",[s._v("binder-rabbit")])])]),s._v(" "),e("li",[e("p",[s._v("在 09 中添加 actuator 依赖")])]),s._v(" "),e("li",[e("p",[s._v("yml 配置添加 rabbitmq 连接配置")]),s._v(" "),e("ul",[e("li",[s._v("修改 09 的 application.yml")]),s._v(" "),e("li",[s._v("修改 config 目录的三个配置文件，提交推送到远程仓库")])])]),s._v(" "),e("li",[e("p",[s._v("修改 09 的 yml 配置，暴露 bus-refresh 刷新路径")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("m.e.w.e.i=bus-refresh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("p",[s._v("测试：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("GET http://localhost:6001/actuator\n查看确认，是否已经暴露 bus-refresh 刷新路径\n\nPOST http://localhost:6001/actuator/bus-refresh\n观察 2,3,4 的控制台，有没有执行刷新操作\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h2",{attrs:{id:"sleuth-zipkin-链路跟踪"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sleuth-zipkin-链路跟踪"}},[s._v("#")]),s._v(" Sleuth + Zipkin 链路跟踪")]),s._v(" "),e("p",[e("strong",[s._v("Sleuth")])]),s._v(" "),e("p",[s._v("产生链路跟踪日志的工具")]),s._v(" "),e("p",[s._v("添加 Sleuth 只需要添加它的依赖，0配置")]),s._v(" "),e("p",[s._v("A --\x3e B --\x3e C --\x3e D")]),s._v(" "),e("p",[s._v("日志数据：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("A, 87J6H5GF34F, 87J6H5GF34F, "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nB, 87J6H5GF34F, OI67U545Y43, "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nC, 87J6H5GF34F, U45Y46U56Y3, "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nD, 87J6H5GF34F, U545T234264, "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("修改 2,3,4,6，添加 sleuth 依赖")]),s._v(" "),e("p",[e("strong",[s._v("链路跟踪日志发送到 rabbitmq：")])]),s._v(" "),e("ol",[e("li",[s._v("修改2,3,4,6添加依赖： zipkin client")]),s._v(" "),e("li",[s._v("单独修改 6，添加 rabbitmq\n"),e("ul",[e("li",[s._v("rabbitmq依赖")]),s._v(" "),e("li",[s._v("rabbitmq连接配置")])])]),s._v(" "),e("li",[s._v("yml配置发送方式： "),e("code",[s._v("zipkin.sender.type=rabbit")]),s._v(" "),e("ul",[e("li",[s._v("06修改  application.yml")]),s._v(" "),e("li",[s._v("2,3,4修改 config  目录的三个文件，再提交推送")])])])]),s._v(" "),e("p",[e("strong",[s._v("启动 zipkin 服务：")])]),s._v(" "),e("p",[s._v("在磁盘找到 zipkin 的 jar 文件，地址栏输入 cmd 启动命令行，执行启动命令：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 旧版本")]),s._v("\njava -jar zipkin-server-2.12.9-exec.jar --zipkin.collector.rabbitmq.uri"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("amqp://admin:admin@192.168.64.140:5672\n\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新版本")]),s._v("\njava -jar zipkin-server-2.23.4-exec.jar --zipkin.collector.rabbitmq.uri"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("amqp://admin:admin@192.168.64.140:5672\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h2",{attrs:{id:"eureka注册-选择正确网卡、注册ip而不是主机名"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eureka注册-选择正确网卡、注册ip而不是主机名"}},[s._v("#")]),s._v(" eureka注册，选择正确网卡、注册ip而不是主机名")]),s._v(" "),e("p",[e("strong",[s._v("选择正确网卡：")])]),s._v(" "),e("p",[s._v("使用 "),e("strong",[s._v("bootstrap.yml")]),s._v(" 在引导阶段来选择网卡")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("inetutils")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ignored-interfaces")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 忽略的网卡")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" VM.*\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preferred-networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要是用的网卡的网段")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 192\\.168\\.0\\..+\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[e("strong",[s._v("注册ip而不是主机名：")])]),s._v(" "),e("p",[s._v("使用 "),e("strong",[s._v("application.yml")]),s._v(" 配置")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("eureka")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("instance")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("prefer-ip-address")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用ip进行注册")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("instance-id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("spring.cloud.client.ip"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("spring.application.name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("server.port"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"订单流量削峰"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#订单流量削峰"}},[s._v("#")]),s._v(" 订单流量削峰")]),s._v(" "),e("p",[e("strong",[s._v("导入项目到 rabbitmq 工程：")])]),s._v(" "),e("ol",[e("li",[s._v("课前资料/elasticsearch/pd-商城项目案例.zip\n把 pd\\pd-web 文件夹，解压缩到 rabbitmq 工程目录")]),s._v(" "),e("li",[s._v("pd-web\\pom.xml 拖拽到 idea")]),s._v(" "),e("li",[s._v("修改 springboot 版本： "),e("code",[s._v("2.3.2.RELEASE")])]),s._v(" "),e("li",[s._v("导入项目： 在编辑器中右键 -- add as maven project")]),s._v(" "),e("li",[s._v("application.yml  数据库连接密码")])]),s._v(" "),e("p",[e("strong",[s._v("导入数据库：")])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("sqlyog，右键点数据库的连接 -- 从sql转储文件导入 -- 选择 pd-web 文件夹的  pd.sql")])]),s._v(" "),e("li",[e("p",[s._v("如果导入失败，执行四条sql，增大mysql的缓存区，再重新导入")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("global")]),s._v(" max_allowed_packet"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("global")]),s._v(" net_buffer_length"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v("  interactive_timeout"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("28800000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v("  wait_timeout"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("28800000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("清除数据：")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pd_user"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pd_order"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pd_order_item"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])])]),s._v(" "),e("p",[e("strong",[s._v("启动 pd-web：")])]),s._v(" "),e("ol",[e("li",[s._v("右键执行 RunPdAPP")]),s._v(" "),e("li",[s._v("启动配置中，设置 working directory\n设置成 pd-web  模块文件夹路径")]),s._v(" "),e("li",[s._v("重启 RunPdAPP")]),s._v(" "),e("li",[s._v("访问 "),e("code",[s._v("http://localhost")])]),s._v(" "),e("li",[s._v("如果浏览器在下载文件，先清空浏览器缓存再重新访问")])]),s._v(" "),e("p",[e("strong",[s._v("订单发送到 rabbitmq：")])]),s._v(" "),e("ol",[e("li",[s._v("添加  rabbitmq 依赖")]),s._v(" "),e("li",[s._v("yml 添加 rabbitmq 连接配置")]),s._v(" "),e("li",[s._v("配置使用的队列的参数：\norderQueue，持久，非独占，不自动删除\n"),e("ul",[e("li",[s._v("使用 spring 的 Queue 对象，来封装队列参数")])])]),s._v(" "),e("li",[s._v("修改 OrderServiceImipl ，完成订单发送\n"),e("ul",[e("li",[s._v("注入 AmqpTemplate 工具对象")]),s._v(" "),e("li",[s._v("调用它的 convertAndSend() 方法，发送订单\n"),e("ul",[e("li",[s._v("这个方法，把订单对象自动序列化变成 byte[] 数组再发送")])])])])])]),s._v(" "),e("h2",{attrs:{id:"分布式事务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分布式事务"}},[s._v("#")]),s._v(" 分布式事务")]),s._v(" "),e("h3",{attrs:{id:"业务案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#业务案例"}},[s._v("#")]),s._v(" 业务案例")]),s._v(" "),e("ol",[e("li",[s._v("pom.xml 继承 order-parent")]),s._v(" "),e("li",[s._v("yml\n"),e("ul",[e("li",[s._v("app.name")]),s._v(" "),e("li",[s._v("port")]),s._v(" "),e("li",[s._v("eureka")]),s._v(" "),e("li",[s._v("datasource")]),s._v(" "),e("li",[s._v("mybatis")]),s._v(" "),e("li",[s._v("sql语句日志")])])]),s._v(" "),e("li",[s._v("实体类")]),s._v(" "),e("li",[s._v("Mapper")]),s._v(" "),e("li",[s._v("Service")]),s._v(" "),e("li",[s._v("Controller")])]),s._v(" "),e("h3",{attrs:{id:"全局唯一id发号器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#全局唯一id发号器"}},[s._v("#")]),s._v(" 全局唯一id发号器")]),s._v(" "),e("ol",[e("li",[s._v("解压到 seata-at 目录")]),s._v(" "),e("li",[s._v("文件夹改名："),e("code",[s._v("easy-id-generator")])]),s._v(" "),e("li",[s._v("pom.xml 拖拽到 idea，修改springboot版本：2.3.2.RELEASE")]),s._v(" "),e("li",[s._v("代码中右键--add as maven project")]),s._v(" "),e("li",[s._v("添加 "),e("code",[s._v("bootstrap.yml")])]),s._v(" "),e("li",[e("code",[s._v("application.yml")]),s._v(" 添加 eureka 配置、app.name")]),s._v(" "),e("li",[s._v("配置 id 生成算法开关：\n"),e("ul",[e("li",[s._v("雪花算法 -- "),e("strong",[s._v("false")])]),s._v(" "),e("li",[s._v("segment -- "),e("strong",[s._v("true")]),s._v(" -- 根据库表中记录的参数来生成id")])])]),s._v(" "),e("li",[s._v("配置数据库连接")])]),s._v(" "),e("h3",{attrs:{id:"订单调用发号器、库存、账户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#订单调用发号器、库存、账户"}},[s._v("#")]),s._v(" 订单调用发号器、库存、账户")]),s._v(" "),e("ol",[e("li",[s._v("启动类添加 "),e("code",[s._v("@EnableFeignClients")])]),s._v(" "),e("li",[s._v("定义三个远程调用接口：\n"),e("ul",[e("li",[s._v("AccountClient")]),s._v(" "),e("li",[s._v("StorageClient")]),s._v(" "),e("li",[s._v("EasyIdClient")])])]),s._v(" "),e("li",[s._v("OrderServiceImpl 中完成远程调用")])]),s._v(" "),e("h2",{attrs:{id:"分布式事务-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分布式事务-2"}},[s._v("#")]),s._v(" 分布式事务")]),s._v(" "),e("h3",{attrs:{id:"seata"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#seata"}},[s._v("#")]),s._v(" seata")]),s._v(" "),e("ul",[e("li",[s._v("阿里的开源项目")]),s._v(" "),e("li",[s._v("一站式分布式事务解决方案")]),s._v(" "),e("li",[s._v("支持的事务方案\n"),e("ul",[e("li",[s._v("XA")]),s._v(" "),e("li",[s._v("SAGA")]),s._v(" "),e("li",[e("strong",[s._v("AT")])]),s._v(" "),e("li",[e("strong",[s._v("TCC")])])])])]),s._v(" "),e("h3",{attrs:{id:"seata-at-事务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#seata-at-事务"}},[s._v("#")]),s._v(" seata at 事务")]),s._v(" "),e("h5",{attrs:{id:"启动事务协调器-tc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动事务协调器-tc"}},[s._v("#")]),s._v(" 启动事务协调器（TC）")]),s._v(" "),e("ol",[e("li",[s._v("从 seata 官网下载 seata server（TC）")]),s._v(" "),e("li",[s._v("解压")]),s._v(" "),e("li",[s._v("修改三个配置文件\n"),e("ul",[e("li",[e("strong",[s._v("regiestry.conf")]),s._v("\n向eureka注册")]),s._v(" "),e("li",[e("strong",[s._v("file.conf")]),s._v("\nseata server运行日志的存储位置")]),s._v(" "),e("li",[e("strong",[s._v("seata-server.bat")]),s._v("\n使用的内存\n苹果电脑修改 seata-server.sh")])])]),s._v(" "),e("li",[s._v("cmd 中运行 seata-server.bat")]),s._v(" "),e("li",[s._v("访问注册表，查看有没有 seata-server")])]),s._v(" "),e("ul",[e("li",[s._v("jdk必须是1.8")]),s._v(" "),e("li",[s._v("seata server 命令窗口不能关闭")]),s._v(" "),e("li",[s._v("抽口中不能选中")])]),s._v(" "),e("h5",{attrs:{id:"三个业务模块中添加-seata-at-事务配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三个业务模块中添加-seata-at-事务配置"}},[s._v("#")]),s._v(" 三个业务模块中添加 seata at 事务配置")]),s._v(" "),e("ol",[e("li",[s._v("seata 依赖")]),s._v(" "),e("li",[s._v("三个配置文件\n"),e("ul",[e("li",[e("strong",[s._v("application.yml")]),s._v("\n对事务组命名")]),s._v(" "),e("li",[e("strong",[s._v("registry.conf")]),s._v("\n连接eureka，获取 seata server （TC）的地址")]),s._v(" "),e("li",[e("strong",[s._v("file.conf")]),s._v("\n事务组对应使用的协调器")])])]),s._v(" "),e("li",[s._v("定一个自动配置类，创建数据源代理对象")]),s._v(" "),e("li",[s._v("业务方法上添加注解\n"),e("ul",[e("li",[s._v("@Transactional --  控制本地数据库事务（和全局事务无关）")]),s._v(" "),e("li",[s._v("@GlobalTransactional --  启动全局事务，只在第一个模块添加")])])])]),s._v(" "),e("h3",{attrs:{id:"tcc-事务方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tcc-事务方案"}},[s._v("#")]),s._v(" TCC 事务方案")]),s._v(" "),e("p",[s._v("两个阶段的三种操作：")]),s._v(" "),e("ul",[e("li",[s._v("第一个阶段：\n"),e("ul",[e("li",[e("strong",[s._v("Try")]),s._v("\n预留资源，冻结数据")])])]),s._v(" "),e("li",[s._v("第二个阶段：\n"),e("ul",[e("li",[e("strong",[s._v("Confirm")]),s._v("\n确认资源，使用第一阶段冻结的数据，完成业务")]),s._v(" "),e("li",[e("strong",[s._v("Cancel")]),s._v("\n取消资源，把第一阶段冻结的数据，再恢复回去")])])])]),s._v(" "),e("p",[s._v("有侵入的事务方案，所有数据操作都需要自己实现，之前学的业务代码需要调整，底层数据库表结构也要调整。")]),s._v(" "),e("p",[s._v("有些复杂情况下，AT事务方案无法自动进行事务控制，就需要手动控制的事务方案。")]),s._v(" "),e("h5",{attrs:{id:"新建工程-导入无事务版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#新建工程-导入无事务版本"}},[s._v("#")]),s._v(" 新建工程，导入无事务版本")]),s._v(" "),e("ol",[e("li",[s._v("新建 Empty project 工程： seata-tcc")]),s._v(" "),e("li",[s._v("seata-at/无事务版本.zip\n解压缩到 seata-tcc 工程目录")]),s._v(" "),e("li",[s._v("double shift --- action -- 搜索add maven project")]),s._v(" "),e("li",[s._v("选择 order-parent 的 pom.xml 导入")])]),s._v(" "),e("h5",{attrs:{id:"添加-tcc-事务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加-tcc-事务"}},[s._v("#")]),s._v(" 添加 TCC  事务")]),s._v(" "),e("ol",[e("li",[s._v("seata 依赖")]),s._v(" "),e("li",[s._v("三个配置文件\n"),e("ul",[e("li",[e("strong",[s._v("application.yml")]),s._v("\n对事务组命名")]),s._v(" "),e("li",[e("strong",[s._v("registry.conf")]),s._v("\n连接eureka，获取 seata server （TC）的地址")]),s._v(" "),e("li",[e("strong",[s._v("file.conf")]),s._v("\n事务组对应使用的协调器")])])]),s._v(" "),e("li",[s._v("调整数据库表结构")]),s._v(" "),e("li",[s._v("Mapper 添加新的数据库操作")]),s._v(" "),e("li",[s._v("ResultHolder，幂等性控制")]),s._v(" "),e("li",[s._v("按 seata tcc 的规则，定义 TccAction 接口、实现\n用来执行 TCC 三个操作")]),s._v(" "),e("li",[s._v("TccAction 的三个方法要添加 @Transactional，控制本地事务（和全局事务无关）")]),s._v(" "),e("li",[s._v("业务方法中，不再直接执行业务，要改成调用 TccAction 的第一阶段方法，冻结数据")]),s._v(" "),e("li",[s._v("第一个模块业务方法上添加 @GlobalTransactional")])]),s._v(" "),e("p",[s._v("TCC 的三个方法，")]),s._v(" "),e("ul",[e("li",[s._v("第一阶段方法，需要手动调用")]),s._v(" "),e("li",[s._v("第二阶段方法，由 seata 的 RM 组件（资源管理器）接收TC指令，然后自动执行")])]),s._v(" "),e("h5",{attrs:{id:"tcc的两个问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tcc的两个问题"}},[s._v("#")]),s._v(" TCC的两个问题")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("第一阶段冻结数据失败，第二阶段仍然会执行回滚，可能引起数据混乱")])]),s._v(" "),e("li",[e("p",[s._v("第二阶段，如果运行超时或出错，TC会重试执行第二阶段，")]),s._v(" "),e("p",[s._v("可能会重复的提交数据，或重复的回滚数据，造成数据混乱。")])])]),s._v(" "),e("h5",{attrs:{id:"幂等性控制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#幂等性控制"}},[s._v("#")]),s._v(" 幂等性控制")]),s._v(" "),e("p",[s._v("一次操作成功，和多次操作的结果相同")]),s._v(" "),e("h2",{attrs:{id:"rocketmq"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rocketmq"}},[s._v("#")]),s._v(" Rocketmq")]),s._v(" "),e("h3",{attrs:{id:"搭建服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#搭建服务器"}},[s._v("#")]),s._v(" 搭建服务器")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("克隆 centos-8-2105：rocketmq")])]),s._v(" "),e("li",[e("p",[s._v("设置ip:")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./ip-static\nip: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".64.141\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果ip设置失败，参考上面 vmware ip设置")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("上传文件到 /root/")]),s._v(" "),e("ul",[e("li",[s._v("分布式事务\\rocketmq\\\n"),e("ul",[e("li",[s._v("jdk-8u212-linux-x64.tar.gz")]),s._v(" "),e("li",[s._v("rocketmq-all-4.9.2-bin-release.zip")]),s._v(" "),e("li",[s._v("rocketmq-dashboard-1.0.1-SNAPSHOT.jar")])])])])]),s._v(" "),e("li",[e("p",[s._v("根据csdn笔记，搭建rocketmq："),e("a",{attrs:{href:"https://wanght.blog.csdn.net/article/details/106963070",target:"_blank",rel:"noopener noreferrer"}},[s._v("RocketMQ (一) 安装"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("所有文件下载都不用执行")])])])]),s._v(" "),e("h3",{attrs:{id:"rocketmq启动命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rocketmq启动命令"}},[s._v("#")]),s._v(" Rocketmq启动命令")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/rocketmq/\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动name server")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" bin/mqnamesrv "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动broker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" bin/mqbroker -n localhost:9876 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果需要从配置文件启动 broker：")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#nohup sh bin/mqbroker -n localhost:9876 -c conf/broker.conf &")]),s._v("\n\n\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#切换到主目录")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动管理界面")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" java -jar rocketmq-dashboard-1.0.1-SNAPSHOT.jar --server.port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(" --rocketmq.config.namesrvAddr"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("localhost:9876 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看进程，要包含：name server、broker、jar")]),s._v("\njps\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("h3",{attrs:{id:"rocketmq-收发消息api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rocketmq-收发消息api"}},[s._v("#")]),s._v(" Rocketmq  收发消息api")]),s._v(" "),e("ol",[e("li",[s._v("新建Empty project工程： rocketmq-dtx")]),s._v(" "),e("li",[s._v("新建 maven 模块： rocketmq-api")]),s._v(" "),e("li",[s._v("添加 rocketmq 依赖，从 rocketmq(四) 笔记复制")]),s._v(" "),e("li",[s._v("测试消息收发方式：\n"),e("ul",[e("li",[s._v("同步消息")]),s._v(" "),e("li",[s._v("延时消息")]),s._v(" "),e("li",[s._v("顺序消息")]),s._v(" "),e("li",[s._v("事务消息")])])])]),s._v(" "),e("h3",{attrs:{id:"可靠消息最终一致性事务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#可靠消息最终一致性事务"}},[s._v("#")]),s._v(" 可靠消息最终一致性事务")]),s._v(" "),e("p",[s._v("用Rocketmq的事务消息实现")]),s._v(" "),e("h5",{attrs:{id:"导入项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导入项目"}},[s._v("#")]),s._v(" 导入项目")]),s._v(" "),e("ol",[e("li",[s._v("seata-at\\无事务版本.zip\n解压缩到 rocketmq-dtx 工程目录")]),s._v(" "),e("li",[s._v("导入 order-parent\\pom.xml")]),s._v(" "),e("li",[s._v("检查项目jdk和语言版本")])]),s._v(" "),e("h5",{attrs:{id:"添加可靠消息最终一致性事务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加可靠消息最终一致性事务"}},[s._v("#")]),s._v(" 添加可靠消息最终一致性事务")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("订单 ----\x3e 账户")])]),s._v(" "),e("li",[e("p",[s._v("用消息服务做异步调用")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("修改订单")])])])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("父项目pom.xml添加rocketmq依赖")])]),s._v(" "),e("li",[e("p",[s._v("application.yml")]),s._v(" "),e("ul",[e("li",[s._v("name server 地址")]),s._v(" "),e("li",[s._v("生产者组的组名")])])]),s._v(" "),e("li",[e("p",[s._v("添加数据库表tx_table，用来存储本地事务的执行状态")])]),s._v(" "),e("li",[e("p",[s._v("添加实体类 tx_info")])]),s._v(" "),e("li",[e("p",[s._v("添加 TxMapper")])]),s._v(" "),e("li",[e("p",[s._v("用来封装消息数据的工具：  AccountMessage(userId, money, xid)")])]),s._v(" "),e("li",[e("p",[s._v("JsonUtil")])]),s._v(" "),e("li",[e("p",[s._v("修改 OrderServiceImpl")]),s._v(" "),e("ul",[e("li",[s._v("业务方法中发送事务消息")]),s._v(" "),e("li",[s._v("在监听器中执行本地事务、处理事务状态回查")])])])]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("修改账户，接收消息执行账户扣减")])])]),s._v(" "),e("ol",[e("li",[s._v("yml配置\n"),e("ul",[e("li",[s._v("name server")])])]),s._v(" "),e("li",[s._v("AccountMessage")]),s._v(" "),e("li",[s._v("JsonUtil")]),s._v(" "),e("li",[s._v("新建消费者类：AccountConsumer")]),s._v(" "),e("li",[s._v("用注解配置接收消息")]),s._v(" "),e("li",[s._v("调用业务方法 AccountService.decrease() 完成金额扣减")])]),s._v(" "),e("h2",{attrs:{id:"devops-开发运维一体化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#devops-开发运维一体化"}},[s._v("#")]),s._v(" DevOps 开发运维一体化")]),s._v(" "),e("ul",[e("li",[s._v("一部分运维工作，要交给开发做")]),s._v(" "),e("li",[s._v("开发人员在Docker容器中部署自己的应用运行环境")])]),s._v(" "),e("h3",{attrs:{id:"docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),e("p",[s._v("为什么使用Docker")]),s._v(" "),e("ol",[e("li",[s._v("提高开发-测试-运维流程效率")]),s._v(" "),e("li",[s._v("在服务器上可以大量部署Docker容器，充分发挥服务器的运算能力")])]),s._v(" "),e("p",[s._v("什么时候使用")]),s._v(" "),e("p",[s._v("以后部署应用，都要使用Docker部署")]),s._v(" "),e("p",[s._v("Docker基本概念")]),s._v(" "),e("ul",[e("li",[s._v("镜像")]),s._v(" "),e("li",[s._v("容器")])]),s._v(" "),e("p",[s._v("Docker服务器")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("克隆 docker-base： docker")])]),s._v(" "),e("li",[e("p",[s._v("设置ip")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./ip-static\nip: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".64.150\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果设置ip失败，参考上面vmware笔记")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("上传文件到 /root/：")]),s._v(" "),e("ul",[e("li",[s._v("docker-images.gz")]),s._v(" "),e("li",[s._v("tomcat文件夹")])])]),s._v(" "),e("li",[e("p",[s._v("导入镜像： "),e("code",[s._v("docker load -i docker-images.gz")])])])]),s._v(" "),e("h2",{attrs:{id:"elasticsearch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch"}},[s._v("#")]),s._v(" Elasticsearch")]),s._v(" "),e("h3",{attrs:{id:"搭建-es-服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#搭建-es-服务器"}},[s._v("#")]),s._v(" 搭建 ES 服务器")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("克隆 docker-base： es")])]),s._v(" "),e("li",[e("p",[s._v("设置虚拟机内存：右键点es虚拟机 --- 设置 --- 内存设置成2G")])]),s._v(" "),e("li",[e("p",[s._v("设置ip:")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./ip-static\nip: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".64.181\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("上传文件到 /root/")]),s._v(" "),e("ul",[e("li",[s._v("pditems 文件夹")]),s._v(" "),e("li",[s._v("elasticsearch-analysis-ik-7.9.3.zip")]),s._v(" "),e("li",[s._v("es-img.gz")])])]),s._v(" "),e("li",[e("p",[s._v("导入镜像： "),e("code",[s._v("docker load -i es-img.gz")])])]),s._v(" "),e("li",[e("p",[s._v("重启docker系统服务："),e("code",[s._v("systemctl restart docker")])])]),s._v(" "),e("li",[e("p",[s._v("设置一个系统的底层参数，重启服务器：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vm.max_map_count=262144'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/etc/sysctl.conf\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v(" -r now\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("按照 csdn笔记启动 es 容器："),e("a",{attrs:{href:"https://wanght.blog.csdn.net/article/details/109145574",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch（一）Docker搭建ES集群"),e("OutboundLink")],1)]),s._v(" "),e("p",[e("img",{attrs:{src:t(1188),alt:"image-20220411173130250"}})])])]),s._v(" "),e("h3",{attrs:{id:"拼多商城搜索条"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#拼多商城搜索条"}},[s._v("#")]),s._v(" 拼多商城搜索条")]),s._v(" "),e("ol",[e("li",[s._v("添加 elasticsearch 依赖")]),s._v(" "),e("li",[s._v("yml配置es服务器地址")]),s._v(" "),e("li",[s._v("新建实体类 Item，用来封装 pditems 索引中的数据")]),s._v(" "),e("li",[s._v("定义 ItemRepository 数据访问接口")]),s._v(" "),e("li",[s._v("添加搜索方法： findByTitleOrSellPoint()\n"),e("ul",[e("li",[s._v("分页")]),s._v(" "),e("li",[s._v("高亮")])])]),s._v(" "),e("li",[s._v("SearchService")]),s._v(" "),e("li",[s._v("SearchController")]),s._v(" "),e("li",[s._v("search.jsp")])]),s._v(" "),e("h3",{attrs:{id:"kubernetes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes"}},[s._v("#")]),s._v(" Kubernetes")]),s._v(" "),e("ul",[e("li",[s._v("容器的自动部署管理工具")]),s._v(" "),e("li",[s._v("谷歌的开源工具")]),s._v(" "),e("li",[s._v("缩写 K8s 或 Kube")])]),s._v(" "),e("h3",{attrs:{id:"安装搭建-k8s-集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装搭建-k8s-集群"}},[s._v("#")]),s._v(" 安装搭建 K8s 集群")]),s._v(" "),e("p",[s._v("辅助安装k8s几群的开源工具：")]),s._v(" "),e("ul",[e("li",[s._v("一键安装脚本")]),s._v(" "),e("li",[s._v("一步一步手动安装")])]),s._v(" "),e("h5",{attrs:{id:"集群方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#集群方案"}},[s._v("#")]),s._v(" 集群方案")]),s._v(" "),e("ul",[e("li",[s._v("三台服务器 -- 16G或以上内存")]),s._v(" "),e("li",[s._v("两台服务器 -- 8G")])]),s._v(" "),e("h5",{attrs:{id:"安装集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装集群"}},[s._v("#")]),s._v(" 安装集群")]),s._v(" "),e("h5",{attrs:{id:""}},[e("a",{staticClass:"header-anchor",attrs:{href:"#"}},[s._v("#")])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("克隆 centos-8-2105：k1")])]),s._v(" "),e("li",[e("p",[s._v("设置ip")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./ip-static \nip: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".64.191\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("上传文件")])])]),s._v(" "),e("ul",[e("li",[s._v("DevOps课前资料\\kubernetes\\\n"),e("ul",[e("li",[s._v("images.gz 传到 "),e("code",[s._v("/root/")])]),s._v(" "),e("li",[s._v("kubeasz-3.1.0.zip解压缩\n"),e("ul",[e("li",[s._v("kubeasz-3.1.0/"),e("code",[s._v("ezdown")]),s._v(" 传到 "),e("code",[s._v("/root/")])]),s._v(" "),e("li",[s._v("kubeasz-3.1.0/"),e("code",[s._v("kubeasz文件夹")]),s._v(" 传到 "),e("code",[s._v("/etc/")])])])])])])]),s._v(" "),e("ol",{attrs:{start:"4"}},[e("li",[e("p",[s._v("设置内存和cpu")]),s._v(" "),e("ol",[e("li",[s._v("右键点虚拟机 --- 设置")]),s._v(" "),e("li",[s._v("内存 2G+")]),s._v(" "),e("li",[s._v("cpu 2块")]),s._v(" "),e("li",[s._v("重启服务器："),e("code",[s._v("shutdown -r now")])])])]),s._v(" "),e("li",[e("p",[s._v("安装docker")])])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 脚本文件添加执行权限")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x ./ezdown\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载所有的离线安装文件，如果文件存在不会重复下载")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行脚本文件安装docker")]),s._v("\n./ezdown -D\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确认docker安装成功")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("ol",{attrs:{start:"6"}},[e("li",[e("p",[s._v("导入测试用的镜像")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" load -i images.gz\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("k1关机，再从 k1 克隆： k2、k3")]),s._v(" "),e("ul",[e("li",[s._v("设置k2和k3的ip：\n"),e("ul",[e("li",[s._v("192.168.64.192")]),s._v(" "),e("li",[s._v("192.168.64.193")])])])])]),s._v(" "),e("li",[e("p",[s._v("启动安装集群过程中使用的临时容器")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./ezdown -S\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("安装方式设置成离线安装")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/^INSTALL_SOURCE.*$/INSTALL_SOURCE: \"offline\"/g'")]),s._v(" /etc/kubeasz/example/config.yml \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("配置 191 免密登录192和193")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成公钥和私钥")]),s._v("\nssh-keygen -t rsa -b "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" -N "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v(" -f ~/.ssh/id_rsa\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 公钥复制到所有服务器")]),s._v("\nssh-copy-id "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".64.191\n\nssh-copy-id "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".64.192\n\nssh-copy-id "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".64.193\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("创建集群方案的配置")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/kubeasz\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x ezctl\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新建方案 cs1，会新建cs1文件夹，复制默认的样例配置到cs1文件夹下")]),s._v("\n./ezctl new cs1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("编辑 cs1 方案的 hosts 文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/kubeasz/clusters/cs1/hosts\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:t(1189),alt:"image-20220413154817590"}})])]),s._v(" "),e("li",[e("p",[s._v("三台服务器拍摄快照，保留当前服务器状态\n如果集群安装失败可以恢复到快照状态重新安装")]),s._v(" "),e("ul",[e("li",[s._v("可以关闭其他无关应用释放内存")]),s._v(" "),e("li",[s._v("或者重启电脑释放内存")]),s._v(" "),e("li",[s._v("或者适当增加虚拟机内存")])])]),s._v(" "),e("li",[e("p",[s._v("执行一键安装")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/kubeasz\n\n./ezctl setup cs1 all\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"k8s三个核心概念"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#k8s三个核心概念"}},[s._v("#")]),s._v(" K8s三个核心概念")]),s._v(" "),e("ul",[e("li",[s._v("Pod\n是Docker容器的封装对象")]),s._v(" "),e("li",[s._v("控制器\n用来自动部署或销毁容器")]),s._v(" "),e("li",[s._v("Service\n不变的访问地址")])]),s._v(" "),e("h2",{attrs:{id:"小结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),e("h3",{attrs:{id:"spring-cloud-netflix-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spring-cloud-netflix-2"}},[s._v("#")]),s._v(" Spring cloud Netflix")]),s._v(" "),e("ul",[e("li",[s._v("注册中心 -- eureka，nacos")]),s._v(" "),e("li",[s._v("配置中心 -- spring cloud config，nacos")]),s._v(" "),e("li",[s._v("API网关 -- zuul，gateway")]),s._v(" "),e("li",[s._v("远程调用、负载均衡 -- feign、ribbon，dubbo")]),s._v(" "),e("li",[s._v("容错、限流 -- hystrix，sentinel")]),s._v(" "),e("li",[s._v("数据监控\n"),e("ul",[e("li",[s._v("hystrix dashboard + turbine，错误监控，sentinel")]),s._v(" "),e("li",[s._v("sleuth + zipkin，链路监控")])])])]),s._v(" "),e("h3",{attrs:{id:"消息服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#消息服务"}},[s._v("#")]),s._v(" 消息服务")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("使用场景：解耦、削峰、异步调用")])]),s._v(" "),e("li",[e("p",[s._v("具体项目案例：")]),s._v(" "),e("ul",[e("li",[s._v("BUS配置刷新")]),s._v(" "),e("li",[s._v("Sleuth+Zipkin链路跟踪日志")]),s._v(" "),e("li",[s._v("订单的流量削峰")]),s._v(" "),e("li",[s._v("Rocketmq的可靠消息最终一致性事务")])])]),s._v(" "),e("li",[e("p",[s._v("Rabbitmq")]),s._v(" "),e("ul",[e("li",[s._v("六种模式：简单，工作，发布和订阅，路由，主题，RPC")])])]),s._v(" "),e("li",[e("p",[s._v("Rocketmq")]),s._v(" "),e("ul",[e("li",[s._v("延时、顺序、事务")])])])]),s._v(" "),e("h3",{attrs:{id:"分布式事务-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分布式事务-3"}},[s._v("#")]),s._v(" 分布式事务")]),s._v(" "),e("ul",[e("li",[s._v("Seata\n"),e("ul",[e("li",[s._v("AT -- 80%场景使用AT事务")]),s._v(" "),e("li",[s._v("TCC")])])]),s._v(" "),e("li",[s._v("Rocketmq 的可靠消息最终一致性事务\n"),e("ul",[e("li",[s._v("场景：使用消息服务做异步调用")])])])]),s._v(" "),e("h3",{attrs:{id:"devops"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#devops"}},[s._v("#")]),s._v(" DevOps")]),s._v(" "),e("ul",[e("li",[s._v("Docker")]),s._v(" "),e("li",[s._v("Kubernetes")])]),s._v(" "),e("h3",{attrs:{id:"elasticsearch-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-2"}},[s._v("#")]),s._v(" Elasticsearch")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("倒排索引")])]),s._v(" "),e("li",[e("p",[s._v("概念：索引、分片、副本、映射、类别、文档、字段")])]),s._v(" "),e("li",[e("p",[s._v("Spring data elasticsearch -- Repository")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);